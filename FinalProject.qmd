---
title: "Final Project"
author: "Andrew Gray, Benjamin Brazier, Brandon Liu, Grant Fisher"
format: pdf
knitr: 
  opts_chunk: 
    echo: false
    warning: false
    message: false
    fig.width: 4
    fig.height: 3
---

Introduction: 

Chronic liver disease can be characterized by progressive destruction and regeneration of the liver parenchyma for at least six months, leading to fibrosis and cirrhosis. It is caused by factors like viral hepatitis, excessive alcohol consumption, obesity, and certain genetic and autoimmune disorders. Symptoms can include fatigue, nausea, and jaundice, and complications can range from fluid buildup to liver failure and cancer (Sharma & Nagalli, 2023). 

Chronic liver disease is a major global health problem, responsible for roughly one in every twenty-five deaths worldwide, and its burden is projected to increase further as alcohol-related disease and metabolic dysfunction–associated steatotic liver disease becomes more common (Plunkett et al., 2025).  

Decisions about whether to accept or decline a liver for transplant are often made quickly and under uncertainty. Donor glucose is routinely measured, but it is not clear how much weight clinicians should give hyperglycemia when judging graft quality (NHS Blood and Transplant, n.d.). At the same time, doing a new prospective study would be expensive and slow, so using an existing dataset that already links donor characteristics to early graft outcomes is a practical way to explore this question. 

Prior studies have shown that donor metabolic health and peri-transplant glucose control may influence liver transplant outcomes. For example, analyses suggest that livers from donors with diabetes are associated with poorer graft survival than those from non-diabetic donors, indicating that donor metabolic status can affect graft quality (Zheng et al., 2014). Other work has found that recipient hyperglycemia around the time of transplant is linked to higher risks of infection, rejection, acute kidney injury, and mortality, and that tighter postoperative glucose control may reduce complications (Rameshi et al., 2025).  

This dataset is well-suited to the problem because it includes, for each transplant, (i) detailed donor information, (ii) key recipient factors such as age and MELD score, and (iii) glucose observations in liver graft. This structure allows us to ask if there is an association between donors with higher glucose and recipients transplanted liver function, while adjusting for other clinically important variables. 

The observational unit in this study is a single deceased‐donor liver transplant (one donor-recipient pair). Our primary outcome is delayed_fn, a binary indicator of early delayed liver graft function in the recipient during the first postoperative week. The main exposure is donor hyperglycemia, summarized by the time-weighted average donor glucose glutwa; while also considering related measures such as the number of donor glucose measurements (glucount) and glucose variability (glurange, glusd). 

As potential confounders, we include recipient and donor characteristics. Recipient variables include age, sex, race, body-mass index, and MELD score. Donor variables include age, sex, race, cause of death, serum sodium, liver steatosis, hypotension/hemodynamic instability, and a composite donor risk index. We also consider cold ischemia time (cold_ischemia). One way in modeling hyperglycemia and liver function, we could treat delayed_fn as the binary response, use glutwa as the main predictor, and adjust for a clinically motivated subset of these covariates to assess whether higher donor glucose is associated with increased odds of delayed graft dysfunction. 

Data on donors, grafts, and recipients were collected for 591 liver transplants between January 2005 and October 2010 at the Cleveland Clinic. Excluded were grafts from living donors, donors after cardiac death, and transplants for which the donor’s glucose level was measured fewer than 2 times. Graft dysfunction, the outcome, was defined as (1) primary nonfunction as indicated by death or retransplant during the first postoperative week or (2) liver graft dysfunction as indicated by an aspartate aminotransferase level greater than 2000 U/L any time between postoperative days 2 and 7 or a prothrombin time greater than 16 seconds any time between postoperative days 2 and 7 (Perez-Protto et al., 2014). 


Results:
```{r}
library(tidyverse)
df <- read.csv("DonorHyperglycemia.csv")

df <- df |>
  mutate(delayed_fn = factor(delayed_fn, levels = c(0,1),
                             labels = c("NoDysfunction","Dysfunction")))

df <- df |>
  mutate(
    log2_glutwa   = log2(glutwa),
    log2_glurange = log2(glurange + 1e-3),
    log2_glusd    = log2(glusd + 1e-3)
  )

df <- df |>
  mutate(
    hyperglycemia = if_else(glutwa > 180, 1, 0),
    hyperglycemia = factor(hyperglycemia,
                           levels = c(0,1),
                           labels = c("NoHyper","Hyper"))
  )


df <- df |>
  mutate(
    r_genderf   = factor(r_genderf, levels = c(0,1), labels = c("Male","Female")),
    d_genderf   = factor(d_genderf, levels = c(0,1), labels = c("Male","Female")),
    r_caucasian = factor(r_caucasian, levels = c(0,1), labels = c("Other","Caucasian")),
    d_caucasian = factor(d_caucasian, levels = c(0,1), labels = c("Other","Caucasian")),
    sbp_lt_90   = factor(sbp_lt_90, levels = c(0,1), labels = c("No","Yes")),
    hemo_instability = factor(hemo_instability, levels = c(0,1), labels = c("No","Yes")),
    steatosis   = factor(steatosis, levels = c(0,1), labels = c("No","Yes"))
  )
vars_main <- c("delayed_fn","hyperglycemia",
               "donorrisk","cold_ischemia",
               "d_age","d_caucasian","d_genderf","steatosis",
               "sbp_lt_90","hemo_instability",
               "r_age","r_bmi","r_caucasian","r_genderf","r_meld_calc")

df_main <- df |> drop_na(all_of(vars_main))

fit_hyper <- glm(
  delayed_fn ~ hyperglycemia +
    donorrisk + cold_ischemia +
    d_age + d_caucasian + d_genderf + steatosis +
    sbp_lt_90 + hemo_instability +
    r_age + r_bmi + r_caucasian + r_genderf + r_meld_calc,
  data = df_main,
  family = binomial
)
summary(fit_hyper)

hyper_or <- broom::tidy(fit_hyper, exponentiate = TRUE, conf.int = TRUE)
hyper_or
```

```{r}
library(tidyverse)
library(ggplot2)

hyper_or_clean <- hyper_or |> 
  filter(term != "(Intercept)") |> 
  mutate(
    term = recode(term,
      "hyperglycemiaHyper" = "Donor Hyperglycemia",
      "donorrisk" = "Donor Risk Index",
      "cold_ischemia" = "Cold Ischemia Time (hrs)",
      "d_age" = "Donor Age",
      "d_caucasianCaucasian" = "Donor Caucasian",
      "d_genderFemale" = "Donor Female",
      "steatosisYes" = "Donor Steatosis >10%",
      "sbp_lt_90Yes" = "SBP < 90 mmHg",
      "hemo_instabilityYes" = "Hemodynamic Instability",
      "r_age" = "Recipient Age",
      "r_bmi" = "Recipient BMI",
      "r_caucasianCaucasian" = "Recipient Caucasian",
      "r_genderFemale" = "Recipient Female",
      "r_meld_calc" = "Recipient MELD"
    )
  )

ggplot(hyper_or_clean, aes(x = term, y = estimate, ymin = conf.low, ymax = conf.high)) +
  geom_pointrange() +
  coord_flip() +
  geom_hline(yintercept = 1, linetype = "dashed") +
  scale_y_log10() +
  labs(
    title = "Adjusted Odds Ratios for Predictors of Delayed Graft Dysfunction",
    x = "",
    y = "Odds Ratio (log scale)"
  )

```
Summarized table of crucial predictors with references in context of the data. Hyperglycemia defined as TWA glucose >180 mg/dL, consistent with clinical thresholds (universal ICU threshold): 

| Predictor               | OR       | 95% CI          | p-value 
| ----------------------- | -------- | --------------- | ------- 
| **Donor Hyperglycemia** | **1.73** | 0.79 – 3.89     | 0.177   
| Donor Risk Index        | 4.62     | 0.94 – 23.53    | 0.059   
| Cold Ischemia Time      | 1.00     | 0.9986 – 1.0044 | 0.319   
| Donor Age               | 1.00     | 0.96 – 1.02     | 0.639   
| Donor Caucasian Race    | 2.06     | 0.77 – 6.21     | 0.171   
| Donor Female            | 0.85     | 0.36 – 1.99     | 0.718   
| Steatosis (>10%)        | 2.91     | 0.92 – 9.03     | 0.065   
| SBP < 90 mmHg           | 4.33     | 0.95 – 20.43    | 0.057   
| Hemodynamic Instability | 0.67     | 0.26 – 1.80     | 0.415   
| Recipient Age           | 1.00     | 0.97 – 1.03     | 0.924     
| Recipient BMI           | 0.94     | 0.87 – 1.00     | 0.079     
| Recipient Caucasian Race| 0.58     | 0.24 – 1.45     | 0.241     
| Recipient Female        | 0.65     | 0.25 – 1.50     | 0.312     
| **Recipient MELD        | **1.05** | **1.00 – 1.09** | **0.043** 


The estimate that corresponds to donor hyperglycemia as indicated by the graph is 0.548 under the null hypothesis that follows a standard normal distribution, holding all other predictors constant. This means that the log odds of delayed graft dysfunction for those who have hyperglycemia increase by 0.548 as compared to the reference group. The null hypothesis is that donor hyperglycemia has no association with delayed graft dysfunction, holding all other predictors constant. The alternative hypothesis is donor hyperglycemia is associated with delayed graft dysfunction, holding all other predictors constant. There is no statistically significant evidence that donors with hyperglycemia (>180 mg/dL) increase the risk of delayed graft dysfunction in recipients. Despite the adjusted odds ratio indicating that those who had hyperglycemia have 1.73 times the odds of having delayed graft dysfunction than the reference group given all other predictors are held constant, the confidence interval is extremely wide and includes values under 1. More importantly, the p-value that corresponds with Donor Hyperglycemia is 0.177 which is greater than our significance level of 0.05. Thus, we would fail to reject the null hypothesis.

As an aside, some other strong predictors, though not all statistically significant, were Donor Risk Index, Systolic Blood Pressure below 90, and Steatosis, with odds ratios (multiplicative values) of 4.6, 4.3, and 2.9 respectively when compared to reference groups or baseline values. All of these predictors had p-values slightly above the significance level of 0.05 (0.059, 0.057, and 0.065 respectively). The only statistically significant predictor for delayed graft dysfunction was the recipient MELD score, which makes sense considering its used to estimate short-term mortality risk in advanced liver disease. The corresponding p-value to the predictor was 0.043 which is  below our significance level of 0.05, meaning that recipients who are sicker at baseline (higher MELD score) have higher odds of delayed graft function. Since donor hyperglycemia—even at clinically elevated levels—was not associated with delayed liver graft function, it may be best to minimize donor risk, improve donor blood flow stability, and prioritize recipients with appropriate MELD severity rather than modifying donor glucose management in order to optimize graft outcomes. 

Works Cited: 
 

NHS Blood and Transplant. (n.d.). Accepting or declining an offer for a liver. NHS Blood and Transplant. Retrieved December 1, 2025, from https://www.nhsbt.nhs.uk/organ-transplantation/liver/receiving-a-liver/accepting-or-declining-an-offer-for-a-liver/ 

Perez-Protto, S. E., Reynolds, L. F., Dalton, J. E., Taketomi, T., Irefin, S. A., Parker, B. M., Quintini, C., & Sessler, D. I. (2014). Deceased donor hyperglycemia and liver graft dysfunction. Progress in Transplantation, 24(1), 106–112. https://doi.org/10.7182/pit2014737 

Plunkett, J. J., Thinzar, T., Bloom, P. P., Brennan, P. N., Duarte-Rojo, A., Puri, Y., Rammoham, A., Rockell, K., & Tavabie, O. D. (2025). Addressing global variation and systemic inequities in access to liver transplantation. npj Gut and Liver, 2, 30. https://doi.org/10.1038/s44355-025-00045-9 

Rameshi, Y., Dashti-Khavidaki, S., Rabizadeh, S., Alimadadi, M., Moradi, A., Kasraianfard, A., Jafarian, A., & Ahmadinejad, Z. (2025). Peri-liver transplant hyperglycemia: Mechanisms, associated factors, consequences, and management – A systematic review. Endocrinology, Diabetes & Metabolism, 8(5), e70107. https://doi.org/10.1002/edm2.70107 

Sharma, A., & Nagalli, S. (2023). Chronic liver disease. In StatPearls. StatPearls Publishing. https://www.ncbi.nlm.nih.gov/books/NBK554597/ 

Zheng, J., Li, J., Zhu, Y., Wang, S., Chen, J., Lin, X., Qian, Y., Jin, L., & Yan, S. (2014). Liver grafts for transplantation from donors with diabetes mellitus. PLOS ONE, 9(6), e98104. https://doi.org/10.1371/journal.pone.0098104 



 

 

 