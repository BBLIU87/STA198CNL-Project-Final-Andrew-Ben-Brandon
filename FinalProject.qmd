---
title: "Final Project"
author: "Andrew Gray, Benjamin Brazier, Brandon Liu, Grant Fisher"
format: pdf
knitr: 
  opts_chunk: 
    echo: false
    warning: false
    message: false
    fig.width: 4
    fig.height: 3
---

## Introduction: 

Chronic liver disease can be characterized by progressive destruction and regeneration of the liver parenchyma for at least six months, leading to fibrosis and cirrhosis. It is caused by factors like viral hepatitis, excessive alcohol consumption, obesity, and certain genetic and autoimmune disorders. Symptoms can include fatigue, nausea, and jaundice, and complications can range from fluid buildup to liver failure and cancer (Sharma & Nagalli, 2023). 

Chronic liver disease is a major global health problem, responsible for roughly one in every twenty-five deaths worldwide, and its burden is projected to increase further as alcohol-related disease and metabolic dysfunction–associated steatotic liver disease becomes more common (Plunkett et al., 2025).  

Decisions about whether to accept or decline a liver for transplant are often made quickly and under uncertainty. Donor glucose is routinely measured, but it is not clear how much weight clinicians should give hyperglycemia when judging graft quality (NHS Blood and Transplant, n.d.). At the same time, doing a new prospective study would be expensive and slow, so using an existing dataset that already links donor characteristics to early graft outcomes is a practical way to explore this question. 

Prior studies have shown that donor metabolic health and peri-transplant glucose control may influence liver transplant outcomes. For example, analyses suggest that livers from donors with diabetes are associated with poorer graft survival than those from non-diabetic donors, indicating that donor metabolic status can affect graft quality (Zheng et al., 2014). Other work has found that recipient hyperglycemia around the time of transplant is linked to higher risks of infection, rejection, acute kidney injury, and mortality, and that tighter postoperative glucose control may reduce complications (Rameshi et al., 2025).  

This dataset is well-suited to the problem because it includes, for each transplant, (i) detailed donor information, (ii) key recipient factors such as age and MELD score, and (iii) glucose observations in liver graft. This structure allows us to ask if there is an association between donors with higher glucose and recipients transplanted liver function, while adjusting for other clinically important variables. 

The observational unit in this study is a single deceased‐donor liver transplant (one donor-recipient pair). Our primary outcome is delayed_fn, a binary indicator of early delayed liver graft function in the recipient during the first postoperative week. The main exposure is donor hyperglycemia, summarized by the time-weighted average donor glucose glutwa; while also considering related measures such as the number of donor glucose measurements (glucount) and glucose variability (glurange, glusd). 

As potential confounders, we include recipient and donor characteristics. Recipient variables include age, sex, race, body-mass index, and MELD score. Donor variables include age, sex, race, cause of death, serum sodium, liver steatosis, hypotension/hemodynamic instability, and a composite donor risk index. We also consider cold ischemia time (cold_ischemia). One way in modeling hyperglycemia and liver function, we could treat delayed_fn as the binary response, use glutwa as the main predictor, and adjust for a clinically motivated subset of these covariates to assess whether higher donor glucose is associated with increased odds of delayed graft dysfunction. 

Data on donors, grafts, and recipients were collected for 591 liver transplants between January 2005 and October 2010 at the Cleveland Clinic. Excluded were grafts from living donors, donors after cardiac death, and transplants for which the donor’s glucose level was measured fewer than 2 times. Graft dysfunction, the outcome, was defined as (1) primary nonfunction as indicated by death or retransplant during the first postoperative week or (2) liver graft dysfunction as indicated by an aspartate aminotransferase level greater than 2000 U/L any time between postoperative days 2 and 7 or a prothrombin time greater than 16 seconds any time between postoperative days 2 and 7 (Perez-Protto et al., 2014). 



```{r}
library(tidyverse)


df <- read.csv("DonorHyperglycemia.csv")

glucose_vars <- c("glutwa", "glurange", "glusd")



df <- df |>
  mutate(
    log2_glutwa   = log2(glutwa),
    log2_glurange = log2(glurange),
    log2_glusd    = log2(glusd)
  )



fit <- glm(delayed_fn ~ cold_ischemia + r_height + r_weight + r_bmi + r_age + r_caucasian + r_genderf + r_meld_assign + r_meld_calc + d_age + d_cod + d_caucasian + d_genderf + donorrisk + sodium + steatosis + sbp_lt_90 + hemo_instability + glucount + log2_glutwa + log2_glurange + log2_glusd,
           data = df, 
           family = binomial)
summary(fit)

library(broom)
library(dplyr)
library(ggplot2)
library(e1071)

glucose_vars <- c("glutwa", "glurange", "glusd")

# 1. Numerical skewness values
sapply(df[glucose_vars], skewness)

odds_ratio_graph <- broom::tidy(fit, exponentiate = TRUE, conf.int = TRUE) |>
  filter(term != "(Intercept)") |>
  mutate(
    predictor = recode(
      term,
      "log2_glutwa"   = "Donor glucose TWA (per doubling)",
      "log2_glurange" = "Donor glucose range (per doubling)",
      "log2_glusd"    = "Donor glucose SD (per doubling)",
      "donorrisk"     = "Donor risk index",
      "cold_ischemia" = "Cold ischemia time (per hour)",
      "r_meld_calc"   = "Recipient MELD (per point)",
      "glucount"      = "Number of glucose readings"   # added
    )
  )

ggplot(
  odds_ratio_graph,
  aes(x = predictor, y = estimate, ymin = conf.low, ymax = conf.high)
) +
  geom_pointrange() +
  geom_hline(yintercept = 1, linetype = "dashed") +
  coord_flip() +
  scale_y_log10() +
  labs(
    title = "Adjusted odds ratios for delayed liver graft dysfunction",
    x = "",
    y = "Odds ratio (log scale)"
  )


```



## Methodology:

A logistic regression model was used because the response variable, delayed liver graft function (delayed_fn), is a binary categorical variable. A linear model was not used because, while some variables like the number of glucose observations in the liver graft (glucount) and the time-weighted average of glucose observations in the liver graft (glutwa) are numerical variables, one continuous and one discrete, the main response variable is a binary categorical variable.

After the dataset is loaded, the variables specific to glucose levels are transformed to log-odds variables. This improves linearity in the log-odds, accounting for that assumption of logistic regression models. Next, the logistic regression model was fit, relating all of the variables, including the log-transformed variables and donor specific variables such as donor age (d_age) and donor gender (d_genderf), to the delayed liver graft function. A summary of this model was shown as a table with an estimate, standard error, z-value, and p-value for each variable in relation to delayed liver graft function. Finally, a graph was made that compares the odds ratio for each variable on a 95% confidence interval, plotting odds ratio on the x-axis and all the variables separately on the y-axis. 

The two assumptions for a logistic regression model are independence and linearity in the log-odds. The independence assumption is satisfied, as each data point corresponds to one organ transplant and there are no repeat organ transplants in the data. The assumption of linearity in the log-odds is satisfied, as the variables of interest are log-transformed.

## Results:

The null hypothesis is that there is not an association between the donor having hyperglycemia on delayed graft dysfunction in the recipient. The alternative hypothesis is that there is  an association between the donor having hyperglycemia on delayed graft dysfunction in the recipient. Holding other predictors in the model constant, we did not find enough statistically significant evidence that donor hyperglycemia—whether measured by time-weighted average glucose (TWA), glucose range, or glucose standard deviation—is associated with delayed graft dysfunction.

For time-weighted average glucose (log₂ TWA), there was an odds ratio of approximately 1.17, representing a 17% increase in odds of dysfunction per doubling of TWA glucose, holding all other predictors constant. However, a wide confidence interval of 0.57–2.38 (odds ratios) and a p-value of 0.67 which is higher than a significance level of 0.05 suggest insufficient evidence to reject the null hypothesis. The same can be said for log2 transformed glucose range with an odds ratio 2.09, suggesting high glucose variability could increase risk of delayed graft dysfunction, but once again the odds ratio confidence interval was extremely wide (0.46–9.57) and the p-value of 0.34 is significantly above 0.05, providing insufficient evidence to reject the null hypothesis. Finally, glucose standard deviation had the highest p-value of 0.54 which is well above the signficance level of 0.05, failing to support a rejection of the null hypothesis. Overall, the combination of nonsignificant p-values, wide confidence intervals, and modest effect sizes all point toward a lack of  evidence that donor hyperglycemia or glucose variability independently is associated with delayed graft dysfunction when clinically relevant covariates are included. 

In contrast, the number of donor glucose measurements (glucount) showed a statistically significant association. With an odds ratio of 0.8, supporting 20% reduction in odds of delayed dysfunction per additional glucose measurement while holding other predictors constant, a confidence interval entirely below 1, and a p-value of 0.0285 which is less than a significane value of 0.05. A clinical explanation for this might be the fact that more frequent glucose measurements likely reflect closer metabolic monitoring and more attentive donor management, potentially including more timely insulin administration and higher quality intensive care. The association may just be because glucount may serve as a proxy for overall donor care quality, a potential confounder to be cautious of.

## Discussion:

The study aimed to determine whether donor hyperglycemia is associated with delayed graft dysfunction. By looking at all glucose measures, we found no statistically significant associations, indicating that donor hyperglycemia from a time weighted average of glucose standpoint, does not appear to independently predict early graft dysfunction once other clinical factors are considered and all other variables are held constant. The conclusions are directly supported by the results since the wide confidence intervals and non-statistically significant p-values suggest a lack of evidence to reject the null hypothesis. However, the study’s methodology does have limitations. The logistic regression model included many predictors relative to the size of the sample, which can increase the risk of over fitting. Additionally, glucose exposure may be misclassified because measurement frequency and timing were likely not standardized across donors. These reasons would affect both reliability and validity and could make it difficult to detect small but clinically meaningful associations. If we were to repeat this study, we would reduce the number of predictors or use other methods to prevent over fitting. It would also help to have more detailed information about how donors were managed. More plainly, it would have been helpful to have direct information and data regarding whether the donors had hyperglycemia so that we could make more concrete assertions. 

## Works Cited: 
 

NHS Blood and Transplant. (n.d.). Accepting or declining an offer for a liver. NHS Blood and Transplant. Retrieved December 1, 2025, from https://www.nhsbt.nhs.uk/organ-transplantation/liver/receiving-a-liver/accepting-or-declining-an-offer-for-a-liver/ 

Perez-Protto, S. E., Reynolds, L. F., Dalton, J. E., Taketomi, T., Irefin, S. A., Parker, B. M., Quintini, C., & Sessler, D. I. (2014). Deceased donor hyperglycemia and liver graft dysfunction. Progress in Transplantation, 24(1), 106–112. https://doi.org/10.7182/pit2014737 

Plunkett, J. J., Thinzar, T., Bloom, P. P., Brennan, P. N., Duarte-Rojo, A., Puri, Y., Rammoham, A., Rockell, K., & Tavabie, O. D. (2025). Addressing global variation and systemic inequities in access to liver transplantation. npj Gut and Liver, 2, 30. https://doi.org/10.1038/s44355-025-00045-9 

Rameshi, Y., Dashti-Khavidaki, S., Rabizadeh, S., Alimadadi, M., Moradi, A., Kasraianfard, A., Jafarian, A., & Ahmadinejad, Z. (2025). Peri-liver transplant hyperglycemia: Mechanisms, associated factors, consequences, and management – A systematic review. Endocrinology, Diabetes & Metabolism, 8(5), e70107. https://doi.org/10.1002/edm2.70107 

Sharma, A., & Nagalli, S. (2023). Chronic liver disease. In StatPearls. StatPearls Publishing. https://www.ncbi.nlm.nih.gov/books/NBK554597/ 

Zheng, J., Li, J., Zhu, Y., Wang, S., Chen, J., Lin, X., Qian, Y., Jin, L., & Yan, S. (2014). Liver grafts for transplantation from donors with diabetes mellitus. PLOS ONE, 9(6), e98104. https://doi.org/10.1371/journal.pone.0098104 



 

 

 